"""Kata url: https://www.codewars.com/kata/5d98b6b38b0f6c001a461198."""


def code(string: str) -> str:
    return ''.join(
        '0' * (len(bits := f'{ord(digit) - 48:b}') - 1) + '1' + bits
        for digit in string
    )


def decode(string: str) -> str:
    decoded = ''
    stack = list(string[::-1])

    while stack:
        bit = '0'
        n = 0

        while bit != '1':
            bit = stack.pop()
            n += 1

        decoded += str(int(''.join(stack.pop() for _ in range(n)), 2))

    return decoded


def test_code():
    assert code("62") == "0011100110"
    assert code("55337700") == "001101001101011101110011110011111010"
    assert code("1119441933000055") == (
        "1111110001100100110000110011000110010111011110101010001101001101"
    )
    assert code("69") == "00111000011001"
    assert code("86") == "00011000001110"

    assert code("032") == "1001110110"
    assert code("000100") == "101010111010"
    assert code("975") == "00011001001111001101"
    assert code("99889933") == (
        "00011001000110010001100000011000000110010001100101110111"
    )
    assert code("974") == "00011001001111001100"
    assert code("5191") == "001101110001100111"
    assert code("112222228855") == (
        "11110110011001100110011001100001100000011000001101001101"
    )

    assert code("83199") == "000110000111110001100100011001"
    assert code("55992266775519") == (
        "0011010011010001100100011001011001100011100011100011110011110011010011"
        "011100011001"
    )
    assert code("278") == "011000111100011000"
    assert code("4477221119") == (
        "0011000011000011110011110110011011111100011001"
    )
    assert code("22662219889933") == (
        "0110011000111000111001100110110001100100011000000110000001100100011001"
        "01110111"
    )

    assert code("227733228899") == (
        "01100110001111001111011101110110011000011000000110000001100100011001"
    )
    assert code("29") == "011000011001"
    assert code("240") == "011000110010"
    assert code("55555511119333333444") == (
        "0011010011010011010011010011010011011111111100011001011101110111011101"
        "110111001100001100001100"
    )

    assert code("51933") == "001101110001100101110111"


def test_decode():
    assert decode("10001111") == "07"
    assert decode(
        "0011000011000011000011100011100011100111011101110011100011100011100011"
        "11001111001111001100001100001100"
    ) == "444666333666777444"
    assert decode(
        "0111011111000110010001100000011000001111001111011101110011000011000110"
        "0110"
    ) == "33198877334422"

    assert decode(
        "0011010011010011011010101111110011000011000011000011100011100011100011"
        "1000111000111000011001000110010001100111000110010011110011110011110011"
        "11001111001111"
    ) == "55500011144466666699919777777"

    assert decode(
        "0111011101111100011001001111001111001111001111001111001111011101110111"
        "0110011001100110011001101111111010101100011001000110000001100000011000"
    ) == "3331977777733322222211100019888"

    assert decode(
        "001110001110101011110011010011010011000011000001100000011000"
    ) == "660011554488"

    assert decode(
        "0011000011000011110011110011110011110001100000011000000110000001100000"
        "1100001100"
    ) == "447777888844"
    assert decode("10000110000110") == "082"
    assert decode(
        "0001100000011000110001100111111010111111000110011010000110010001100111"
        "00011001"
    ) == "881911001119009919"
    assert decode(
        "0011000011000011000110011001100110011001100110011001100110011001101100"
        "01100100011000000110000001100000111000111000111000111100111100111100111"
        "0001110001110"
    ) == "44422222222222219888666777666"

    assert decode("00110110") == "50"
    assert decode(
        "1010100011000011000011000001100000011000000110000111011101110001100100"
        "0110010001100101100110011000110000110000110000011000000110000001100000"
        "1110001110001110"
    ) == "000444888333999222444888666"
    assert decode(
        "1111110001100100011001000110010001100100011001000110010001100100011001"
        "00011001000110000001100000011000000110000001100000011000"
    ) == "111999999999888888"
    assert decode(
        "0110011001100111011101111010100110011001100011010011010011010111011101"
        "111100011001"
    ) == "22233300022255533319"
    assert decode(
        "0011010011010011011111110011100011100011100011010011010011010011110011"
        "11001111111111"
    ) == "555111666555777111"

    assert decode(
        "0011100011100111011111000110010001100000011000001100001100"
    ) == "6633198844"
    assert decode(
        "1010100011110011110011110011110011110011111111110001100100011001000110"
        "0100110100110100110111111111000110010001100000011000000110000111011101"
        "11"
    ) == "00077777711199955511119888333"
    assert decode("0001100100011000") == "98"
    assert decode("001100001101") == "45"
    assert decode(
        "1111110001100100111000111001110111001110001110"
    ) == "1119663366"
